import numpy as np
import matplotlib.pyplot as plt
import math

def V(x):
    a = 0.07
    return a * x * x

def energy(s):
    def spectrum(s):
        phi = sol[s,:]
        N = len(phi)
        return 2.0 / N * np.real(np.fft.rfft(phi))
    delta_t = t_array[s-1] - t_array[s+1]
    sp = spectrum(s)
    spb = spectrum(s-1)
    spa = spectrum(s+1)
    L = len(sp)
    def spectrum_dot(s):
        sD = np.zeros(L)
        for j in range(0,L):
         sD[j] = (spa[j] - spb[j]) / delta_t
        return sD
    sd = spectrum_dot(s)
    E = np.zeros(L)
    for i in range(0,L):
     E[i] = (sd[i]*sd[i]/2) + (sp[i]*sp[i]*(i*math.pi/256)*(i*math.pi/256)/2) + V(sp[i])/2
    return E

fig_size = plt.rcParams["figure.figsize"]
fig_size[0] = 15
fig_size[1] = 9
num_plots = 3

colormap = plt.cm.gist_rainbow
plt.gca().set_color_cycle([colormap(i) for i in np.linspace(0, 0.9, num_plots)])

sol_dir = 't*=10/A2/build/fs_sol_1d'
t_array = np.fromfile('%s/t.dat' % sol_dir, dtype='f8')
time_steps = len(t_array)
x_array = np.fromfile('%s/x.dat' % sol_dir, dtype='f8')
nx = len(x_array)
sol = np.fromfile('%s/sol.dat' % sol_dir, dtype='f8').reshape((121, nx))
f_l = energy(73)
NX = len(f_l)
F_l = np.zeros(NX)
for k in range(0,NX):
 F_l[k] = k * f_l[k]
plt.plot(F_l[0:NX])

sol_dir = 't*=12/A2/build/fs_sol_1d'
t_array = np.fromfile('%s/t.dat' % sol_dir, dtype='f8')
time_steps = len(t_array)
x_array = np.fromfile('%s/x.dat' % sol_dir, dtype='f8')
nx = len(x_array)
sol = np.fromfile('%s/sol.dat' % sol_dir, dtype='f8').reshape((121, nx))
f_l = energy(73)
NX = len(f_l)
F_l = np.zeros(NX)
for k in range(0,NX):
 F_l[k] = k * f_l[k]
plt.plot(F_l[0:NX])

sol_dir = 't*=14/A2/build/fs_sol_1d'
t_array = np.fromfile('%s/t.dat' % sol_dir, dtype='f8')
time_steps = len(t_array)
x_array = np.fromfile('%s/x.dat' % sol_dir, dtype='f8')
nx = len(x_array)
sol = np.fromfile('%s/sol.dat' % sol_dir, dtype='f8').reshape((121, nx))
f_l = energy(73)
NX = len(f_l)
F_l = np.zeros(NX)
for k in range(0,NX):
 F_l[k] = k * f_l[k]
plt.plot(F_l[0:NX])

plt.legend([r'$m_{\phi}t_{*}=10.00$', r'$m_{\phi}t_{*}=12.00$', r'$m_{\phi}t_{*}=14.00$'], loc='upper right')
plt.rcParams["figure.figsize"] = fig_size
plt.xscale('log')
plt.axhline(0,color='black',linewidth=0.6)
plt.axis([1,10000,0,0.28])
plt.title(r'Asymmetric Gaussian-2, $\alpha_{\phi}=0.07$, $m_{\phi}t_{p}=256$, $m_{\phi}t=260$', fontsize=17, fontweight='bold')
plt.ylabel(r'$(m_{\phi}x_p/{\pi})k\cdot\epsilon (k)$', fontsize=14)
plt.xlabel(r'$(m_{\phi}x_p/{\pi})k$', fontsize=14)
plt.savefig('Asymmetric_Gaussian_2_a=0.07_tp=256_t=260_logscale_2.png')
plt.close()


sol_dir = 't*=10/A2/build/fs_sol_1d'
t_array = np.fromfile('%s/t.dat' % sol_dir, dtype='f8')
time_steps = len(t_array)
x_array = np.fromfile('%s/x.dat' % sol_dir, dtype='f8')
nx = len(x_array)
sol = np.fromfile('%s/sol.dat' % sol_dir, dtype='f8').reshape((121, nx))
f_l = energy(79)
NX = len(f_l)
F_l = np.zeros(NX)
for k in range(0,NX):
 F_l[k] = k * f_l[k]
plt.plot(F_l[0:NX])

sol_dir = 't*=12/A2/build/fs_sol_1d'
t_array = np.fromfile('%s/t.dat' % sol_dir, dtype='f8')
time_steps = len(t_array)
x_array = np.fromfile('%s/x.dat' % sol_dir, dtype='f8')
nx = len(x_array)
sol = np.fromfile('%s/sol.dat' % sol_dir, dtype='f8').reshape((121, nx))
f_l = energy(79)
NX = len(f_l)
F_l = np.zeros(NX)
for k in range(0,NX):
 F_l[k] = k * f_l[k]
plt.plot(F_l[0:NX])

sol_dir = 't*=14/A2/build/fs_sol_1d'
t_array = np.fromfile('%s/t.dat' % sol_dir, dtype='f8')
time_steps = len(t_array)
x_array = np.fromfile('%s/x.dat' % sol_dir, dtype='f8')
nx = len(x_array)
sol = np.fromfile('%s/sol.dat' % sol_dir, dtype='f8').reshape((121, nx))
f_l = energy(79)
NX = len(f_l)
F_l = np.zeros(NX)
for k in range(0,NX):
 F_l[k] = k * f_l[k]
plt.plot(F_l[0:NX])

plt.legend([r'$m_{\phi}t_{*}=10.00$', r'$m_{\phi}t_{*}=12.00$', r'$m_{\phi}t_{*}=14.00$'], loc='upper right')
plt.rcParams["figure.figsize"] = fig_size
plt.xscale('log')
plt.axhline(0,color='black',linewidth=0.6)
plt.axis([1,10000,0,0.28])
plt.title(r'Asymmetric Gaussian-2, $\alpha_{\phi}=0.07$, $m_{\phi}t_{p}=256$, $m_{\phi}t=280$', fontsize=17, fontweight='bold')
plt.ylabel(r'$(m_{\phi}x_p/{\pi})k\cdot\epsilon (k)$', fontsize=14)
plt.xlabel(r'$(m_{\phi}x_p/{\pi})k$', fontsize=14)
plt.savefig('Asymmetric_Gaussian_2_a=0.07_tp=256_t=280_logscale_2.png')
plt.close()


sol_dir = 't*=10/A2/build/fs_sol_1d'
t_array = np.fromfile('%s/t.dat' % sol_dir, dtype='f8')
time_steps = len(t_array)
x_array = np.fromfile('%s/x.dat' % sol_dir, dtype='f8')
nx = len(x_array)
sol = np.fromfile('%s/sol.dat' % sol_dir, dtype='f8').reshape((121, nx))
f_l = energy(85)
NX = len(f_l)
F_l = np.zeros(NX)
for k in range(0,NX):
 F_l[k] = k * f_l[k]
plt.plot(F_l[0:NX])

sol_dir = 't*=12/A2/build/fs_sol_1d'
t_array = np.fromfile('%s/t.dat' % sol_dir, dtype='f8')
time_steps = len(t_array)
x_array = np.fromfile('%s/x.dat' % sol_dir, dtype='f8')
nx = len(x_array)
sol = np.fromfile('%s/sol.dat' % sol_dir, dtype='f8').reshape((121, nx))
f_l = energy(85)
NX = len(f_l)
F_l = np.zeros(NX)
for k in range(0,NX):
 F_l[k] = k * f_l[k]
plt.plot(F_l[0:NX])

sol_dir = 't*=14/A2/build/fs_sol_1d'
t_array = np.fromfile('%s/t.dat' % sol_dir, dtype='f8')
time_steps = len(t_array)
x_array = np.fromfile('%s/x.dat' % sol_dir, dtype='f8')
nx = len(x_array)
sol = np.fromfile('%s/sol.dat' % sol_dir, dtype='f8').reshape((121, nx))
f_l = energy(85)
NX = len(f_l)
F_l = np.zeros(NX)
for k in range(0,NX):
 F_l[k] = k * f_l[k]
plt.plot(F_l[0:NX])

plt.legend([r'$m_{\phi}t_{*}=10.00$', r'$m_{\phi}t_{*}=12.00$', r'$m_{\phi}t_{*}=14.00$'], loc='upper right')
plt.rcParams["figure.figsize"] = fig_size
plt.xscale('log')
plt.axhline(0,color='black',linewidth=0.6)
plt.axis([1,10000,0,0.28])
plt.title(r'Asymmetric Gaussian-2, $\alpha_{\phi}=0.07$, $m_{\phi}t_{p}=256$, $m_{\phi}t=300$', fontsize=17, fontweight='bold')
plt.ylabel(r'$(m_{\phi}x_p/{\pi})k\cdot\epsilon (k)$', fontsize=14)
plt.xlabel(r'$(m_{\phi}x_p/{\pi})k$', fontsize=14)
plt.savefig('Asymmetric_Gaussian_2_a=0.07_tp=256_t=300_logscale_2.png')
plt.close()


sol_dir = 't*=10/A2/build/fs_sol_1d'
t_array = np.fromfile('%s/t.dat' % sol_dir, dtype='f8')
time_steps = len(t_array)
x_array = np.fromfile('%s/x.dat' % sol_dir, dtype='f8')
nx = len(x_array)
sol = np.fromfile('%s/sol.dat' % sol_dir, dtype='f8').reshape((121, nx))
f_l = energy(91)
NX = len(f_l)
F_l = np.zeros(NX)
for k in range(0,NX):
 F_l[k] = k * f_l[k]
plt.plot(F_l[0:NX])

sol_dir = 't*=12/A2/build/fs_sol_1d'
t_array = np.fromfile('%s/t.dat' % sol_dir, dtype='f8')
time_steps = len(t_array)
x_array = np.fromfile('%s/x.dat' % sol_dir, dtype='f8')
nx = len(x_array)
sol = np.fromfile('%s/sol.dat' % sol_dir, dtype='f8').reshape((121, nx))
f_l = energy(91)
NX = len(f_l)
F_l = np.zeros(NX)
for k in range(0,NX):
 F_l[k] = k * f_l[k]
plt.plot(F_l[0:NX])

sol_dir = 't*=14/A2/build/fs_sol_1d'
t_array = np.fromfile('%s/t.dat' % sol_dir, dtype='f8')
time_steps = len(t_array)
x_array = np.fromfile('%s/x.dat' % sol_dir, dtype='f8')
nx = len(x_array)
sol = np.fromfile('%s/sol.dat' % sol_dir, dtype='f8').reshape((121, nx))
f_l = energy(91)
NX = len(f_l)
F_l = np.zeros(NX)
for k in range(0,NX):
 F_l[k] = k * f_l[k]
plt.plot(F_l[0:NX])

plt.legend([r'$m_{\phi}t_{*}=10.00$', r'$m_{\phi}t_{*}=12.00$', r'$m_{\phi}t_{*}=14.00$'], loc='upper right')
plt.rcParams["figure.figsize"] = fig_size
plt.xscale('log')
plt.axhline(0,color='black',linewidth=0.6)
plt.axis([1,10000,0,0.28])
plt.title(r'Asymmetric Gaussian-2, $\alpha_{\phi}=0.07$, $m_{\phi}t_{p}=256$, $m_{\phi}t=320$', fontsize=17, fontweight='bold')
plt.ylabel(r'$(m_{\phi}x_p/{\pi})k\cdot\epsilon (k)$', fontsize=14)
plt.xlabel(r'$(m_{\phi}x_p/{\pi})k$', fontsize=14)
plt.savefig('Asymmetric_Gaussian_2_a=0.07_tp=256_t=320_logscale_2.png')
plt.close()


sol_dir = 't*=10/A2/build/fs_sol_1d'
t_array = np.fromfile('%s/t.dat' % sol_dir, dtype='f8')
time_steps = len(t_array)
x_array = np.fromfile('%s/x.dat' % sol_dir, dtype='f8')
nx = len(x_array)
sol = np.fromfile('%s/sol.dat' % sol_dir, dtype='f8').reshape((121, nx))
f_l = energy(97)
NX = len(f_l)
F_l = np.zeros(NX)
for k in range(0,NX):
 F_l[k] = k * f_l[k]
plt.plot(F_l[0:NX])

sol_dir = 't*=12/A2/build/fs_sol_1d'
t_array = np.fromfile('%s/t.dat' % sol_dir, dtype='f8')
time_steps = len(t_array)
x_array = np.fromfile('%s/x.dat' % sol_dir, dtype='f8')
nx = len(x_array)
sol = np.fromfile('%s/sol.dat' % sol_dir, dtype='f8').reshape((121, nx))
f_l = energy(97)
NX = len(f_l)
F_l = np.zeros(NX)
for k in range(0,NX):
 F_l[k] = k * f_l[k]
plt.plot(F_l[0:NX])

sol_dir = 't*=14/A2/build/fs_sol_1d'
t_array = np.fromfile('%s/t.dat' % sol_dir, dtype='f8')
time_steps = len(t_array)
x_array = np.fromfile('%s/x.dat' % sol_dir, dtype='f8')
nx = len(x_array)
sol = np.fromfile('%s/sol.dat' % sol_dir, dtype='f8').reshape((121, nx))
f_l = energy(97)
NX = len(f_l)
F_l = np.zeros(NX)
for k in range(0,NX):
 F_l[k] = k * f_l[k]
plt.plot(F_l[0:NX])

plt.legend([r'$m_{\phi}t_{*}=10.00$', r'$m_{\phi}t_{*}=12.00$', r'$m_{\phi}t_{*}=14.00$'], loc='upper right')
plt.rcParams["figure.figsize"] = fig_size
plt.xscale('log')
plt.axhline(0,color='black',linewidth=0.6)
plt.axis([1,10000,0,0.28])
plt.title(r'Asymmetric Gaussian-2, $\alpha_{\phi}=0.07$, $m_{\phi}t_{p}=256$, $m_{\phi}t=340$', fontsize=17, fontweight='bold')
plt.ylabel(r'$(m_{\phi}x_p/{\pi})k\cdot\epsilon (k)$', fontsize=14)
plt.xlabel(r'$(m_{\phi}x_p/{\pi})k$', fontsize=14)
plt.savefig('Asymmetric_Gaussian_2_a=0.07_tp=256_t=340_logscale_2.png')
plt.close()


sol_dir = 't*=10/A2/build/fs_sol_1d'
t_array = np.fromfile('%s/t.dat' % sol_dir, dtype='f8')
time_steps = len(t_array)
x_array = np.fromfile('%s/x.dat' % sol_dir, dtype='f8')
nx = len(x_array)
sol = np.fromfile('%s/sol.dat' % sol_dir, dtype='f8').reshape((121, nx))
f_l = energy(103)
NX = len(f_l)
F_l = np.zeros(NX)
for k in range(0,NX):
 F_l[k] = k * f_l[k]
plt.plot(F_l[0:NX])

sol_dir = 't*=12/A2/build/fs_sol_1d'
t_array = np.fromfile('%s/t.dat' % sol_dir, dtype='f8')
time_steps = len(t_array)
x_array = np.fromfile('%s/x.dat' % sol_dir, dtype='f8')
nx = len(x_array)
sol = np.fromfile('%s/sol.dat' % sol_dir, dtype='f8').reshape((121, nx))
f_l = energy(103)
NX = len(f_l)
F_l = np.zeros(NX)
for k in range(0,NX):
 F_l[k] = k * f_l[k]
plt.plot(F_l[0:NX])

sol_dir = 't*=14/A2/build/fs_sol_1d'
t_array = np.fromfile('%s/t.dat' % sol_dir, dtype='f8')
time_steps = len(t_array)
x_array = np.fromfile('%s/x.dat' % sol_dir, dtype='f8')
nx = len(x_array)
sol = np.fromfile('%s/sol.dat' % sol_dir, dtype='f8').reshape((121, nx))
f_l = energy(103)
NX = len(f_l)
F_l = np.zeros(NX)
for k in range(0,NX):
 F_l[k] = k * f_l[k]
plt.plot(F_l[0:NX])

plt.legend([r'$m_{\phi}t_{*}=10.00$', r'$m_{\phi}t_{*}=12.00$', r'$m_{\phi}t_{*}=14.00$'], loc='upper right')
plt.rcParams["figure.figsize"] = fig_size
plt.xscale('log')
plt.axhline(0,color='black',linewidth=0.6)
plt.axis([1,10000,0,0.28])
plt.title(r'Asymmetric Gaussian-2, $\alpha_{\phi}=0.07$, $m_{\phi}t_{p}=256$, $m_{\phi}t=360$', fontsize=17, fontweight='bold')
plt.ylabel(r'$(m_{\phi}x_p/{\pi})k\cdot\epsilon (k)$', fontsize=14)
plt.xlabel(r'$(m_{\phi}x_p/{\pi})k$', fontsize=14)
plt.savefig('Asymmetric_Gaussian_2_a=0.07_tp=256_t=360_logscale_2.png')
plt.close()


sol_dir = 't*=10/A2/build/fs_sol_1d'
t_array = np.fromfile('%s/t.dat' % sol_dir, dtype='f8')
time_steps = len(t_array)
x_array = np.fromfile('%s/x.dat' % sol_dir, dtype='f8')
nx = len(x_array)
sol = np.fromfile('%s/sol.dat' % sol_dir, dtype='f8').reshape((121, nx))
f_l = energy(109)
NX = len(f_l)
F_l = np.zeros(NX)
for k in range(0,NX):
 F_l[k] = k * f_l[k]
plt.plot(F_l[0:NX])

sol_dir = 't*=12/A2/build/fs_sol_1d'
t_array = np.fromfile('%s/t.dat' % sol_dir, dtype='f8')
time_steps = len(t_array)
x_array = np.fromfile('%s/x.dat' % sol_dir, dtype='f8')
nx = len(x_array)
sol = np.fromfile('%s/sol.dat' % sol_dir, dtype='f8').reshape((121, nx))
f_l = energy(109)
NX = len(f_l)
F_l = np.zeros(NX)
for k in range(0,NX):
 F_l[k] = k * f_l[k]
plt.plot(F_l[0:NX])

sol_dir = 't*=14/A2/build/fs_sol_1d'
t_array = np.fromfile('%s/t.dat' % sol_dir, dtype='f8')
time_steps = len(t_array)
x_array = np.fromfile('%s/x.dat' % sol_dir, dtype='f8')
nx = len(x_array)
sol = np.fromfile('%s/sol.dat' % sol_dir, dtype='f8').reshape((121, nx))
f_l = energy(109)
NX = len(f_l)
F_l = np.zeros(NX)
for k in range(0,NX):
 F_l[k] = k * f_l[k]
plt.plot(F_l[0:NX])

plt.legend([r'$m_{\phi}t_{*}=10.00$', r'$m_{\phi}t_{*}=12.00$', r'$m_{\phi}t_{*}=14.00$'], loc='upper right')
plt.rcParams["figure.figsize"] = fig_size
plt.xscale('log')
plt.axhline(0,color='black',linewidth=0.6)
plt.axis([1,10000,0,0.28])
plt.title(r'Asymmetric Gaussian-2, $\alpha_{\phi}=0.07$, $m_{\phi}t_{p}=256$, $m_{\phi}t=380$', fontsize=17, fontweight='bold')
plt.ylabel(r'$(m_{\phi}x_p/{\pi})k\cdot\epsilon (k)$', fontsize=14)
plt.xlabel(r'$(m_{\phi}x_p/{\pi})k$', fontsize=14)
plt.savefig('Asymmetric_Gaussian_2_a=0.07_tp=256_t=380_logscale_2.png')
plt.close()


sol_dir = 't*=10/A2/build/fs_sol_1d'
t_array = np.fromfile('%s/t.dat' % sol_dir, dtype='f8')
time_steps = len(t_array)
x_array = np.fromfile('%s/x.dat' % sol_dir, dtype='f8')
nx = len(x_array)
sol = np.fromfile('%s/sol.dat' % sol_dir, dtype='f8').reshape((121, nx))
f_l = energy(115)
NX = len(f_l)
F_l = np.zeros(NX)
for k in range(0,NX):
 F_l[k] = k * f_l[k]
plt.plot(F_l[0:NX])

sol_dir = 't*=12/A2/build/fs_sol_1d'
t_array = np.fromfile('%s/t.dat' % sol_dir, dtype='f8')
time_steps = len(t_array)
x_array = np.fromfile('%s/x.dat' % sol_dir, dtype='f8')
nx = len(x_array)
sol = np.fromfile('%s/sol.dat' % sol_dir, dtype='f8').reshape((121, nx))
f_l = energy(115)
NX = len(f_l)
F_l = np.zeros(NX)
for k in range(0,NX):
 F_l[k] = k * f_l[k]
plt.plot(F_l[0:NX])

sol_dir = 't*=14/A2/build/fs_sol_1d'
t_array = np.fromfile('%s/t.dat' % sol_dir, dtype='f8')
time_steps = len(t_array)
x_array = np.fromfile('%s/x.dat' % sol_dir, dtype='f8')
nx = len(x_array)
sol = np.fromfile('%s/sol.dat' % sol_dir, dtype='f8').reshape((121, nx))
f_l = energy(115)
NX = len(f_l)
F_l = np.zeros(NX)
for k in range(0,NX):
 F_l[k] = k * f_l[k]
plt.plot(F_l[0:NX])

plt.legend([r'$m_{\phi}t_{*}=10.00$', r'$m_{\phi}t_{*}=12.00$', r'$m_{\phi}t_{*}=14.00$'], loc='upper right')
plt.rcParams["figure.figsize"] = fig_size
plt.xscale('log')
plt.axhline(0,color='black',linewidth=0.6)
plt.axis([1,10000,0,0.28])
plt.title(r'Asymmetric Gaussian-2, $\alpha_{\phi}=0.07$, $m_{\phi}t_{p}=256$, $m_{\phi}t=400$', fontsize=17, fontweight='bold')
plt.ylabel(r'$(m_{\phi}x_p/{\pi})k\cdot\epsilon (k)$', fontsize=14)
plt.xlabel(r'$(m_{\phi}x_p/{\pi})k$', fontsize=14)
plt.savefig('Asymmetric_Gaussian_2_a=0.07_tp=256_t=400_logscale_2.png')
plt.close()
